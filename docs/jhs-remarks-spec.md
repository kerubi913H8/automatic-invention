# 中学1年生 所見作成支援アプリ 仕様書（ドラフト）

## 0. 文書情報

* 文書名：中学1年生 所見作成支援アプリ 仕様書
* 版数：v0.1（ドラフト）
* 作成日：2026-01-15
* 作成者：—
* 想定読者：開発担当、学校管理職、情報担当、導入ベンダー

---

## 1. 背景・目的

### 1.1 背景（現状課題）

* 所見作成が学期末・年度末に集中し、教員の負担が高い
* 文体・表現・観点が教員ごとにばらつき、品質の統一が難しい
* 過去所見の参照・流用が属人的になりやすい
* 誤字脱字・表記ゆれ・個人情報の取り扱いリスクがある
* 出力形式（校務支援システム取り込み用CSV等）への対応が手作業になりがち

### 1.2 目的（このアプリで実現すること）

* 所見作成の**工数削減（入力→生成→推敲→出力の効率化）**
* 所見の**品質標準化（観点・トーン・禁則語・文字数）**
* **履歴管理**（学期・年度・過去所見の参照、差分）
* **安全な個人情報管理**（権限、ログ、暗号化）
* **出力互換**（Excel/CSV/Word/PDF、校務支援システム用フォーマット）

---

## 2. 対象範囲（スコープ）

### 2.1 対象学年

* 中学1年生（将来的に全学年へ拡張可能な設計とする）

### 2.2 対象文書

* 通知表所見（総合所見・学習面・生活面など、学校の運用に合わせて設定可能）

### 2.3 非対象（当面）

* 成績処理そのもの（評定計算、観点別評価の集計など）
* 保護者配信・ポータル機能（将来拡張候補）

---

## 3. 想定利用者・権限

### 3.1 ロール定義

* 管理者（教務/情報担当）

  * 学校設定、ユーザー管理、テンプレート管理、出力形式設定
* 担任

  * 自クラスの生徒データ閲覧、所見作成、確定、出力
* 教科担当（任意）

  * 教科コメントや観点入力のみ（所見本文は担任が統合）
* 閲覧のみ（任意）

  * 校内承認者が確認のみ可能

### 3.2 権限要件（RBAC）

* 「クラス」「学年」「年度」「学期」単位でアクセス制御
* 生徒の個人情報・所見本文・履歴・出力ファイルは、ロールと担当範囲で制限
* 重要操作（確定、出力、削除、テンプレート変更）は監査ログ対象

---

## 4. 業務フロー（標準）

1. 管理者：年度・学期を作成、観点項目・文字数・出力形式・テンプレートを設定
2. 管理者/担任：生徒名簿を登録（CSVインポート/手入力/校務支援からの取り込み）
3. 担任/教科担当：観点入力（チェック、段階、短文メモ、数値など運用に合わせる）
4. アプリ：所見を生成（テンプレート合成／任意でAI補助）
5. 担任：生成文を編集・推敲（禁則チェック、文字数チェック）
6. 承認フロー（任意）：学年主任等が確認→差戻し
7. 担任：所見を確定（ロック）
8. 出力：CSV/Excel/Word/PDF など指定形式で出力
9. 保管：年度アーカイブ、翌年度への参照

---

## 5. 機能要件

### 5.1 名簿・クラス管理

* 年度/学期/クラスの作成
* 生徒の登録・編集・退学/転出などのステータス管理
* CSVインポート/エクスポート

  * 例：生徒番号、氏名、ふりがな、性別（任意）、クラス、出席番号、配慮事項（閲覧制限）など

### 5.2 観点入力（所見の根拠データ）

* 観点セット（学校ごとに設定）

  * 例：学習意欲、授業態度、提出物、協働性、生活習慣、委員会活動 等
* 入力形式（観点ごとに選択可能）

  * 段階（A/B/C、1〜3、◎○△）
  * チェックボックス（できる/課題/要支援）
  * 自由メモ（短文）
* 一括入力（クラス一覧で表形式入力）
* 過去学期のコピー（次学期の下書き作成）

### 5.3 所見生成（コア）

* **テンプレートベース生成（必須）**

  * 観点値に応じて文章ブロックを組み立て
  * 表現の揺れを抑えるため、言い回し候補を複数持つ（ランダムまたは選択）
* **AI補助生成（任意オプション）**

  * 観点入力＋メモを元に文案を提案
  * 最終確定は必ず教員（Human in the loop）

### 5.4 編集・推敲支援

* 文字数カウント（全角基準の上限を設定可能）
* 禁則語チェック（例：断定的表現、差別的表現、個人情報過多の指摘などを学校で定義）
* 表記ゆれチェック（例：「取り組む/取組む」など辞書）
* 例文・言い換え候補の提示（テンプレ候補）

### 5.5 履歴・バージョン管理

* 学期ごとの所見履歴
* 変更履歴（誰がいつ編集したか）
* 確定後は原則ロック（管理者のみ解除可能）

### 5.6 承認フロー（任意）

* ステータス：下書き → 提出 → 差戻し → 承認 → 確定
* 差戻しコメント、修正依頼の記録

### 5.7 出力

* 出力形式（設定でON/OFF）

  * CSV（校務支援取り込み用）
  * Excel（学級一覧）
  * Word（通知表の差し込み用：差し込みフィールド）
  * PDF（確認・印刷用）
* 出力項目のマッピング設定（列名、順序、文字コード、改行コード）

### 5.8 ユーザー・監査・設定

* ユーザー招待/登録（メールor管理者作成）
* パスワード/SSO（導入形態により）
* 監査ログ（ログイン、閲覧、出力、確定、設定変更）
* バックアップ/復元（管理者）

---

## 6. 画面要件（画面一覧）

1. ログイン
2. ダッシュボード（年度・学期選択、作業進捗、未作成数）
3. クラス一覧（生徒一覧、入力状況、フィルタ）
4. 生徒詳細（観点入力、メモ、所見生成、編集、履歴）
5. 一括入力（表形式）
6. テンプレート管理（管理者）
7. 禁則語・表記辞書管理（管理者）
8. 出力設定（管理者）
9. ユーザー管理（管理者）
10. 監査ログ閲覧（管理者）

---

## 7. 所見生成ロジック仕様

### 7.1 テンプレート方式（推奨：ルール＋部品合成）

* 構成例：

  * 冒頭（全体評価の一文）
  * 学習面（観点群A）
  * 生活面（観点群B）
  * まとめ（次への期待・励まし）
* テンプレートは以下を持つ：

  * 条件（観点値、フラグ、キーワード）
  * 文ブロック候補（複数）
  * 文字数の重み（短/中/長）
  * 禁則回避タグ（例：断定回避、配慮表現）

### 7.2 文字数制約

* 既定：全角120文字（学校で変更可能）
* 超過時の挙動：

  * 自動短縮候補（冗長語削除、言い換え短文化）
  * ブロック削除優先順位（設定可能）

### 7.3 禁則・配慮

* 個人情報過多（家庭事情など）を含みうる語の検出
* 医療・障害等のセンシティブ情報は、入力欄自体を別権限に分離する設計も可

### 7.4 AI補助（オプション）を入れる場合の必須要件

* 送信データ最小化（氏名は送らず「生徒A」等の匿名IDで生成）
* プロンプトに「断定禁止」「比較禁止」「ネガティブ断定回避」「具体的行動に基づく」などの制約
* 生成結果の保存ポリシー（API側に保持されない構成 or 契約に基づく取り扱い）
* 出力前に教員が必ず確認するUI（チェックボックス等）

---

## 8. データ設計（論理モデル案）

### 8.1 主テーブル

* users（教職員）

  * id, name, email, role, status, last_login_at …
* schools（学校）

  * id, name, settings_json …
* academic_terms（年度・学期）

  * id, school_id, year, term（1/2/3）…
* classes

  * id, school_id, academic_term_id, grade, class_name, homeroom_teacher_id …
* students

  * id, school_id, student_no, name, kana, class_id, status …
* criteria_sets（観点セット）

  * id, school_id, name, schema_json（観点定義）
* student_observations（観点入力）

  * id, student_id, academic_term_id, criteria_id, value, memo, created_by …
* remarks（所見本文）

  * id, student_id, academic_term_id, text, status（draft/submitted/approved/locked）, version …
* remark_history（所見履歴）

  * id, remark_id, text, changed_by, changed_at …
* templates（テンプレ）

  * id, school_id, type, condition_json, text_candidates …
* audit_logs

  * id, user_id, action, target_type, target_id, metadata_json, created_at …

---

## 9. システム構成案（おすすめの組み方）

要件として一番効いてくるのは「**個人情報を学校外に出せるか**」です。そこで2案提示します。

### 案A：クラウドWeb（運用が最も楽）

* フロント：Web（PCブラウザ前提）
* バックエンド：APIサーバ（REST）
* DB：PostgreSQL
* ストレージ：出力ファイル保管（暗号化）
* 認証：Google/Microsoft SSO（可能なら）＋2要素
* AI（任意）：外部API（匿名化して送信）

**メリット**：端末更新・保守が軽い、複数端末で作業しやすい
**注意**：自治体/学校の情報セキュリティポリシーに適合させる必要

### 案B：学校内（オンプレ/ローカル）＋WebUI（安全性重視）

* 校内サーバ（または教員PCにローカルサーバ/Docker）
* WebUIでアクセス（校内ネットワークのみ）
* DBは校内に閉じる
* AI補助は使わない、または校内LLM/閉域構成

**メリット**：外部持ち出しを最小化
**注意**：保守・バックアップ・端末環境差の対応が必要

---

## 10. 非機能要件

* 性能：クラス40名規模で一覧表示・一括入力がストレスなく動作（目安：画面応答2秒以内）
* 可用性：クラウド案は稼働率目標を設定（例：月99.5%など）
* バックアップ：日次自動バックアップ、世代管理（例：30日）
* 監査：出力・確定・設定変更のログ保存（例：1年〜規程に準拠）
* セキュリティ：

  * 通信暗号化（HTTPS）
  * 保存時暗号化（DB/ファイル）
  * 役割・担当範囲のアクセス制御
  * 端末の自動ログアウト（例：30分無操作）
* データ保持・削除：年度終了後のアーカイブ/削除ポリシーを設定可能

---

## 11. API要件（例：代表的エンドポイント）

* 認証：POST /auth/login, POST /auth/logout
* 名簿：GET /classes, GET /classes/{id}/students, POST /students/import
* 観点：GET /criteria_sets, POST /students/{id}/observations
* 所見：POST /students/{id}/remarks/generate, PUT /students/{id}/remarks, POST /remarks/{id}/lock
* 出力：POST /exports（形式指定）、GET /exports/{id}/download
* 管理：POST /templates, PUT /settings, GET /audit_logs

---

## 12. テスト観点

* 単体：テンプレ条件分岐、文字数制御、禁則チェック
* 結合：名簿→観点→生成→編集→確定→出力の一連
* セキュリティ：権限越えアクセス、ログ、セッション、ファイルDL権限制御
* 受入：実校の運用（所見文字数、出力フォーマット、承認フロー）で検証

---

## 13. 未決事項（要件確定で詰めるべき点）

以下は仕様を確定する上で影響が大きい項目です。仕様書には「決定事項」として最終的に埋めます。

* 所見の**文字数上限**（全角何文字か、改行可否）
* 所見の**区分**（総合所見のみ／学習面・生活面の分割など）
* 観点の正式名称・段階（A/B/C、1〜3など）
* **承認フロー**の有無（学年主任チェックなど）
* 既存の**校務支援システム連携**の要否（CSV列、文字コード、取り込み仕様）
* クラウド利用可否（自治体/学校の情報セキュリティ方針）
* AI補助の可否（個人情報の外部送信可否、匿名化運用）

---

## 14. 付録：所見テンプレ例（イメージ）

* 冒頭（学習姿勢が高い場合）

  * 「授業では自分の考えを持って意欲的に取り組み、理解を深めています。」
* 生活面（協働性が高い場合）

  * 「周囲と協力しながら活動を進め、学級づくりにも前向きに関わっています。」
* まとめ（次への期待）

  * 「今後はより計画的に学習を進めることで、さらに力を伸ばせるでしょう。」

---

## 推奨する進め方（仕様を固める手順）

1. まず「**出力形式（最終成果物）**」を確定
2. 次に「**観点入力（根拠データ）**」を確定
3. その上で「**生成方式（テンプレ中心＋必要ならAI）**」を決定
4. 最後に「**クラウド/オンプレ**」を決定（セキュリティ方針に依存）

---

必要であれば、このドラフトをベースにして、次の成果物まで一気に落とし込めます（質問で止めずにこちらで仮決めして作れます）。

* 画面遷移図（簡易ワイヤー）
* DBのER図相当（テーブル定義書）
* テンプレート仕様（条件式の書き方、文ブロック管理）
* 出力フォーマット定義（CSV列定義・マッピング）

「AIは使わない（テンプレのみ）」「校務支援システムにCSV取り込み必須」など、方針が既に決まっているものがあれば、その前提で仕様書を**v1.0相当**に具体化して提示します。
